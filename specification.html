<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Job specification - falconeri: Distributed batch processing using Kubernetes</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

        <noscript>
            <style type="text/css">
                .javascript-only {
                    display: none;
                }
            </style>
        </noscript>

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme;
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li><a href="installation.html"><strong aria-hidden="true">2.</strong> Installation</a></li><li><a href="specification.html" class="active"><strong aria-hidden="true">3.</strong> Job specification</a></li><li><a href="images.html"><strong aria-hidden="true">4.</strong> Creating Docker images</a></li><li><a href="commands.html"><strong aria-hidden="true">5.</strong> Commands</a></li><li><ol class="section"><li><a href="commands/connecting.html"><strong aria-hidden="true">5.1.</strong> Connecting</a></li><li><a href="commands/job.html"><strong aria-hidden="true">5.2.</strong> Running jobs</a></li><li><a href="commands/db.html"><strong aria-hidden="true">5.3.</strong> Accessing the database</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons javascript-only">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">falconeri: Distributed batch processing using Kubernetes</h1> 

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                
                <div id="searchbar-outer" class="searchbar-outer">
                    <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                </div>
                <div id="searchresults-outer" class="searchresults-outer">
                    <div class="searchresults-header" id="searchresults-header"></div>
                    <ul id="searchresults">
                    </ul>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="specification.html#job-specification" id="job-specification"><h1>Job specification</h1></a>
<p>Here is a sample job specification:</p>
<pre><code class="language-json">{
  &quot;pipeline&quot;: {
    &quot;name&quot;: &quot;book_words&quot;
  },
  &quot;transform&quot;: {
    &quot;cmd&quot;: [
      &quot;python3&quot;,
      &quot;/extract_words.py&quot;
    ],
    &quot;image&quot;: &quot;somerepo/my_python_nlp&quot;,
    &quot;secrets&quot;: [
      {
        &quot;name&quot;: &quot;ssl&quot;,
        &quot;mount_path&quot;: &quot;/ssl&quot;
      },
      {
        &quot;name&quot;: &quot;s3&quot;,
        &quot;key&quot;: &quot;AWS_ACCESS_KEY_ID&quot;,
        &quot;env_var&quot;: &quot;AWS_ACCESS_KEY_ID&quot;
      }
    ],
    &quot;service_account&quot;: &quot;example-service&quot;
  },
  &quot;parallelism_spec&quot;: {
    &quot;constant&quot;: 10
  },
  &quot;resource_requests&quot;: {
    &quot;memory&quot;: &quot;500Mi&quot;,
    &quot;cpu&quot;: 1.2
  },
  &quot;node_selector&quot;: {
    &quot;node_type&quot;: &quot;falconeri_worker&quot;
  },
  &quot;input&quot;: {
    &quot;atom&quot;: {
      &quot;URI&quot;: &quot;gs://example-bucket/books/&quot;,
      &quot;repo&quot;: &quot;books&quot;,
      &quot;glob&quot;: &quot;/*&quot;
    }
  },
  &quot;egress&quot;: {
    &quot;URI&quot;: &quot;gs://example-bucket/words/&quot;
  }
}

</code></pre>
<p>Some notes:</p>
<ul>
<li><code>parallelism_spec</code> only accepts <code>constant</code>, not <code>coefficient</code>. We don't scale the job to fit the cluster; we scale the cluster to fit the job.</li>
<li><code>resource_requests</code> is mandatory.</li>
<li>The <code>resource_requests.memory</code> value is used as both a request and as a hard limit. This is because we've seen too many problems caused by worker nodes that consume unexpectedly large amounts of RAM, forcing other workers (or cluster infrastructure) to be evicted from the node.</li>
<li><code>node_selector</code> is optional. When present, it allows you to limit which nodes will be used for workers. This also integrates with Kubernetes cluster autoscaling. The autoscaler will look for a node pool with matching tags, and create as many nodes as required to satisfy the <code>resource_requests</code>.</li>
<li><code>service_account</code> is optional. This may be used to specify a Kubernetes service account name, allowing access to the Kubernetes API or to third-party integrations such as credentials from Vault.</li>
<li>For now, <code>input.atom</code> is the only supported input type.</li>
<li><code>egress.URI</code> is mandatory.</li>
</ul>
<a class="header" href="specification.html#s3-authentication" id="s3-authentication"><h2>S3 authentication</h2></a>
<p>In order to authenticate with S3, you will need to create a secret, and add a <code>transform.secrets</code> section to your pipeline specification. This should look like the following, although you may replace the secret name with something other than <code>&quot;s3&quot;</code>. For now, the <code>&quot;key&quot;</code> values must be as specified below for the S3 backend to work.</p>
<pre><code class="language-json">&quot;secrets&quot;: [
  {
    &quot;name&quot;: &quot;s3&quot;,
    &quot;key&quot;: &quot;AWS_ACCESS_KEY_ID&quot;,
    &quot;env_var&quot;: &quot;AWS_ACCESS_KEY_ID&quot;
  },
  {
    &quot;name&quot;: &quot;s3&quot;,
    &quot;key&quot;: &quot;AWS_SECRET_ACCESS_KEY&quot;,
    &quot;env_var&quot;: &quot;AWS_SECRET_ACCESS_KEY&quot;
  }
]
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="installation.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="images.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="installation.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="images.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if (getComputedStyle(document.querySelector(".fa")).fontFamily !== "FontAwesome") {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = '_FontAwesome/css/font-awesome.css';
                document.head.insertBefore(link, document.head.firstChild)
            }
        </script>

        

        

        

        
        <script src="searchindex.js" type="text/javascript" charset="utf-8"></script>
        
        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
